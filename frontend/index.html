<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Mitra</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
body {
  margin: 0;
  font-family: system-ui, sans-serif;
  height: 100vh;
  display: flex;
  background: #f4f6f3;
}

/* SIDEBAR */
.sidebar {
  width: 280px;
  background: #e9f5ec;
  padding: 20px;
  box-sizing: border-box;
}

.app-name {
  font-size: 20px;
  font-weight: 600;
  color: #2f7d32;
}

.app-sub {
  font-size: 13px;
  color: #4a7c50;
  margin-top: 4px;
}

.info {
  margin-top: 30px;
  font-size: 14px;
  line-height: 1.5;
  color: #333;
}

/* MAIN */
.main {
  flex: 1;
  display: flex;
  flex-direction: column;
}

/* TOP BAR */
.topbar {
  padding: 14px 18px;
  background: white;
  border-bottom: 1px solid #ddd;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.title {
  font-weight: 500;
}

/* LANGUAGE BUTTONS */
.lang button {
  border: none;
  background: #2f7d32;
  color: white;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  font-size: 16px;
  margin-left: 8px;
  cursor: pointer;
}

/* CHAT */
.chat {
  flex: 1;
  padding: 22px;
  overflow-y: auto;
}

.msg {
  max-width: 70%;
  padding: 10px 14px;
  margin-bottom: 12px;
  border-radius: 10px;
  line-height: 1.45;
  white-space: pre-wrap;
}

.user {
  background: #d9f2dc;
  margin-left: auto;
}

.bot {
  background: white;
}

/* INPUT */
.input {
  padding: 14px;
  display: flex;
  gap: 10px;
  border-top: 1px solid #ddd;
  background: white;
}

input {
  flex: 1;
  padding: 12px 16px;
  border-radius: 22px;
  border: 1px solid #ccc;
  outline: none;
}

.send {
  background: #2f7d32;
  color: white;
  border: none;
  border-radius: 50%;
  width: 46px;
  height: 46px;
  cursor: pointer;
}
</style>
</head>

<body>

<!-- SIDEBAR -->
<div class="sidebar">
  <div class="app-name" id="appName"></div>
  <div class="app-sub" id="appSub"></div>

  <div class="info" id="sidebarInfo"></div>
</div>

<!-- MAIN -->
<div class="main">

  <div class="topbar">
    <div class="title" id="topTitle"></div>
    <div class="lang">
      <button onclick="setLang('ta')">род</button>
      <button onclick="setLang('ml')">р┤о</button>
      <button onclick="setLang('en')">EN</button>
    </div>
  </div>

  <div class="chat" id="chat"></div>

  <div class="input">
    <input id="prompt" />
    <button class="send" onclick="send()">тЮд</button>
  </div>

</div>

<script>
let currentLang = "en";

/* ЁЯФд FULL TRANSLATION DICTIONARY */
const TEXT = {
  en: {
    appName: "ЁЯМ╛ Mitra",
    welcomeMessage: "Welcome to Karshak Mitra! Ask me anything about farming, crops, soil, pests, irrigation, and weather. How can I assist you today?",
    appSub: "Your Farming Guide",
    sidebarInfo: "Ask doubts about crops, soil, pests, irrigation, and weather.\n\nAlways confirm important decisions with a local agriculture officer.",
    topTitle: "Chat with your farming assistant",
    placeholder: "Ask about crops, weather, pest controlтАж",
    typing: "ThinkingтАж"
  },
  ta: {
    appName: "ЁЯМ╛ рооро┐родрпНро░ро╛",
    welcomeMessage: "ро╡рогроХрпНроХроорпН! роЙроЩрпНроХро│рпН ро╡ро┐ро╡роЪро╛роп роЪроирпНродрпЗроХроЩрпНроХро│рпИ роХрпЗро│рпБроЩрпНроХро│рпН.",
    appSub: "роЙроЩрпНроХро│рпН ро╡ро┐ро╡роЪро╛роп ро╡ро┤ро┐роХро╛роЯрпНроЯро┐",
    sidebarInfo: "рокропро┐ро░рпНроХро│рпН, роорогрпН, рокрпВроЪрпНроЪро┐роХро│рпН, роирпАро░рпНрокрпНрокро╛роЪройроорпН, ро╡ро╛ройро┐ро▓рпИ рокро▒рпНро▒ро┐роп роЪроирпНродрпЗроХроЩрпНроХро│рпИ роХрпЗро│рпБроЩрпНроХро│рпН.\n\nроорпБроХрпНроХро┐роп роорпБроЯро┐ро╡рпБроХро│рпБроХрпНроХрпБ роЙро│рпНро│рпВро░рпН ро╡рпЗро│ро╛рогрпН роЕро▓рпБро╡ро▓ро░рпИ роЕрогрпБроХрпБроЩрпНроХро│рпН.",
    topTitle: "роЙроЩрпНроХро│рпН ро╡ро┐ро╡роЪро╛роп роЙродро╡ро┐ропро╛ро│ро░рпБроЯройрпН роЙро░рпИропро╛роЯро▓рпН",
    placeholder: "рокропро┐ро░рпНроХро│рпН, ро╡ро╛ройро┐ро▓рпИ роХрпБро▒ро┐родрпНродрпБ роХрпЗро│рпБроЩрпНроХро│рпНтАж",
    typing: "рокродро┐ро▓ро│ро┐роХрпНроХро┐ро▒родрпБтАж"
  },
  ml: {
    appName: "ЁЯМ╛ р┤ор┤┐р┤др╡Нр┤░",
    welcomeMessage: "р┤ир┤ор┤╕р╡Нр┤Хр┤╛р┤░р┤В! р┤ир┤┐р┤Щр╡Нр┤Щр┤│р╡Бр┤Яр╡Ж р┤Хр╡Гр┤╖р┤┐ р┤╕р┤Вр┤╢р┤пр┤Щр╡Нр┤Щр╡╛ р┤Ър╡Лр┤жр┤┐р┤Хр╡Нр┤Хр╡В.",
    appSub: "р┤ир┤┐р┤Щр╡Нр┤Щр┤│р╡Бр┤Яр╡Ж р┤Хр╡Гр┤╖р┤┐ р┤ор┤╛р╡╝р┤Чр┤жр╡╝р┤╢р┤Хр╡╗",
    sidebarInfo: "р┤╡р┤┐р┤│р┤Хр╡╛, р┤ор┤гр╡Нр┤гр╡Н, р┤Хр╡Ар┤Яр┤Щр╡Нр┤Щр╡╛, р┤Ьр┤▓р┤╕р╡Зр┤Ър┤ир┤В, р┤Хр┤╛р┤▓р┤╛р┤╡р┤╕р╡Нр┤е р┤Ор┤ир╡Нр┤ир┤┐р┤╡р┤пр╡Жр┤Хр╡Нр┤Хр╡Бр┤▒р┤┐р┤Ър╡Нр┤Ър╡Н р┤Ър╡Лр┤жр┤┐р┤Хр╡Нр┤Хр┤╛р┤В.\n\nр┤кр╡Нр┤░р┤зр┤╛р┤и р┤др╡Ар┤░р╡Бр┤ор┤╛р┤ир┤Щр╡Нр┤Щр╡╛р┤Хр╡Нр┤Хр╡Н р┤Хр╡Гр┤╖р┤┐ р┤Ур┤лр╡Ар┤╕р┤▒р╡Ж р┤╕р┤ор╡Ар┤кр┤┐р┤Хр╡Нр┤Хр╡Бр┤Х.",
    topTitle: "р┤ир┤┐р┤Щр╡Нр┤Щр┤│р╡Бр┤Яр╡Ж р┤Хр╡Гр┤╖р┤┐ р┤╕р┤╣р┤╛р┤пр┤┐р┤пр╡Бр┤ор┤╛р┤пр┤┐ р┤Ър┤╛р┤▒р╡Нр┤▒р╡Н р┤Ър╡Жр┤пр╡Нр┤пр╡В",
    placeholder: "р┤Хр╡Гр┤╖р┤┐ р┤Ър╡Лр┤жр╡Нр┤пр┤В р┤Зр┤╡р┤┐р┤Яр╡Ж р┤Ор┤┤р╡Бр┤др╡Бр┤ХтАж",
    typing: "р┤ор┤▒р╡Бр┤кр┤Яр┤┐ р┤др┤пр╡Нр┤пр┤╛р┤▒р┤╛р┤Хр╡Нр┤Хр╡Бр┤ир╡Нр┤ир╡БтАж"
  }
};

/* ЁЯМН APPLY LANGUAGE TO WHOLE PAGE */
function setLang(lang) {
  currentLang = lang;
  const t = TEXT[lang];

  // translate UI
  document.getElementById("appName").innerText = t.appName;
  document.getElementById("appSub").innerText = t.appSub;
  document.getElementById("sidebarInfo").innerText = t.sidebarInfo;
  document.getElementById("topTitle").innerText = t.topTitle;
  document.getElementById("prompt").placeholder = t.placeholder;

  // ЁЯФе CLEAR CHAT (IMPORTANT)
  const chat = document.getElementById("chat");
  chat.innerHTML = "";

  // ЁЯФе ADD WELCOME MESSAGE IN SELECTED LANGUAGE
  const welcome = document.createElement("div");
  welcome.className = "msg bot";
  welcome.innerText = t.welcomeMessage;
  chat.appendChild(welcome);
}


/* ЁЯТм SEND MESSAGE */
async function send() {
  const chat = document.getElementById("chat");
  const input = document.getElementById("prompt");
  const text = input.value.trim();
  if (!text) return;

  const userMsg = document.createElement("div");
  userMsg.className = "msg user";
  userMsg.innerText = text;
  chat.appendChild(userMsg);

  input.value = "";
  chat.scrollTop = chat.scrollHeight;

  const botMsg = document.createElement("div");
  botMsg.className = "msg bot";
  botMsg.innerText = TEXT[currentLang].typing;
  chat.appendChild(botMsg);
  chat.scrollTop = chat.scrollHeight;

  try {
    const res = await fetch(
      `http://127.0.0.1:8000/chat?prompt=${encodeURIComponent(text)}&lang=${currentLang}`,
      { method: "POST" }
    );
    const data = await res.json();
    botMsg.innerText = data.response;
  } catch {
    botMsg.innerText = "Server not responding.";
  }
}

/* INIT */
setLang("en");
</script>

</body>
</html>
